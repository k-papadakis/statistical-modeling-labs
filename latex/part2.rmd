---
title: "Statistical Modelling - Series 2"
author: Konstantinos Papadakis (DSML 03400149)
date: 5 January 2022
output: "pdf_document"
---

```{r}
library("olsrr")
library("ggplot2")

canary <- read.table("../data/canary.txt", header = TRUE)
canary$group <- as.factor(canary$group)

# This model uses 1 for B and 0 for A.
mod <- lm(Temp ~ pulses * group, data = canary)
steps_all <- ols_step_all_possible(mod)
print(steps_all[order(steps_all$cp),])
```
```{r}
best_vars <- steps_all[which.min(steps_all$cp),]$predictors
best_vars <- strsplit(best_vars, " ")[[1]]
best_formula <- as.formula(paste("Temp", "~", paste0(best_vars, collapse = "+")))
best_mod <- lm(best_formula, data = canary)
summary(best_mod)
```

(When we view our data by group, `group` is essentially part of the intercept, since it's constant)
Case I, Two separate lines: When pulses:group is part of the model.
Case II, Two parallel lines: When pulses:group is not part of the model, but group is part of the model.
Case III, One common line: When neither pulses:group, nor group is part of the model.
In our case, we have pulses + pulses:group. This means that we have two separate lines,
but those lines share the same intercept, because group is not part of the model.
NOTE ALSO THAT PARALLEL LINES ALSO WORK in our case, since pulses + group has an almost equally good R^2.

